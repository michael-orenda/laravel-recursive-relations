openapi: 3.0.3
info:
  title: Laravel Recursive Relations API
  description: API for demonstrating recursive tree traversal using the `michaelorenda/laravel-recursive-relations` package.
  version: 1.0.0
  contact:
    name: Michael Orenda
    email: rminchrist@gmail.com
    url: https://github.com/michael-orenda

servers:
  - url: http://127.0.0.1:8000/api
    description: Local development server

paths:
  /categories:
    get:
      summary: Get all categories
      tags: [Categories]
      responses:
        "200":
          description: A list of categories
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Category"

  /categories/{id}:
    get:
      summary: Get a single category
      tags: [Categories]
      parameters:
        - $ref: "#/components/parameters/CategoryId"
      responses:
        "200":
          description: Category object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Category"
        "404":
          $ref: "#/components/responses/NotFound"

  /categories/{id}/tree:
    get:
      summary: Get category subtree
      tags: [Categories]
      parameters:
        - $ref: "#/components/parameters/CategoryId"
      responses:
        "200":
          description: Tree representation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TreeNode"
        "404":
          $ref: "#/components/responses/NotFound"

  /categories/{id}/descendants:
    get:
      summary: Get category descendants
      tags: [Categories]
      parameters:
        - $ref: "#/components/parameters/CategoryId"
      responses:
        "200":
          description: Descendants list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Category"
        "404":
          $ref: "#/components/responses/NotFound"

  /categories/{id}/ancestors:
    get:
      summary: Get category ancestors
      tags: [Categories]
      parameters:
        - $ref: "#/components/parameters/CategoryId"
      responses:
        "200":
          description: Ancestors list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Category"
        "404":
          $ref: "#/components/responses/NotFound"

  /org:
    get:
      summary: Get all org units
      tags: [Org Units]
      responses:
        "200":
          description: A list of org units
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrgUnit"

  /org/{id}:
    get:
      summary: Get a single org unit
      tags: [Org Units]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: OrgUnit object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrgUnit"
        "404":
          $ref: "#/components/responses/NotFound"

  /org/{id}/tree:
    get:
      summary: Get org unit tree
      tags: [Org Units]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Tree representation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TreeNode"
        "404":
          $ref: "#/components/responses/NotFound"

  /org/{id}/descendants:
    get:
      summary: Get org unit descendants
      tags: [Org Units]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Descendants list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrgUnit"
        "404":
          $ref: "#/components/responses/NotFound"

  /org/{id}/ancestors:
    get:
      summary: Get org unit ancestors
      tags: [Org Units]
      parameters:
        - $ref: "#/components/parameters/OrgId"
      responses:
        "200":
          description: Ancestors list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrgUnit"
        "404":
          $ref: "#/components/responses/NotFound"

components:
  parameters:
    CategoryId:
      name: id
      in: path
      required: true
      schema:
        type: integer
      description: Category ID

    OrgId:
      name: id
      in: path
      required: true
      schema:
        type: integer
      description: OrgUnit ID

  responses:
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  schemas:
    Category:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        parent_id:
          type: integer
          nullable: true

    OrgUnit:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        parent_unit_id:
          type: integer
          nullable: true

    TreeNode:
      type: object
      properties:
        id:
          type: integer
        data:
          type: object
        children:
          type: array
          items:
            $ref: "#/components/schemas/TreeNode"

    ErrorResponse:
      type: object
      properties:
        message:
          type: string
